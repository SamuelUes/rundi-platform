(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,38376,e=>{"use strict";var t=e.i(43476),s=e.i(75469),r=e.i(71645);e.i(51718);var a=e.i(18357),o=e.i(746),l=e.i(8277);function c(){let[e,c]=(0,r.useState)([]),[d,n]=(0,r.useState)([]),[i,m]=(0,r.useState)(!0),[x,h]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=(0,a.onAuthStateChanged)(o.firebaseAuth,async e=>{if(!e){h("Sesión no encontrada."),m(!1);return}try{let t=await e.getIdToken(),s=await fetch("/api/operator/active-drivers",{headers:{Authorization:`Bearer ${t}`}});if(!s.ok){let e=(await s.json().catch(()=>({}))).error||"Error al cargar conductores.";h(e),m(!1);return}let r=await s.json();c(r.areas||[]),n(r.drivers||[]),m(!1)}catch(e){h("Error al comunicar con el servidor."),m(!1)}});return()=>e()},[]);let u=d.reduce((e,t)=>(e[t.areaId]||(e[t.areaId]=[]),e[t.areaId].push(t),e),{});return(0,t.jsx)(s.CmsAuthGuard,{requiredRole:"operator",children:(0,t.jsxs)("main",{className:`flex min-h-screen flex-col ${l.themeColors.appBackground}`,children:[(0,t.jsxs)("header",{className:`border-b px-6 py-4 ${l.themeColors.surface}`,children:[(0,t.jsx)("h1",{className:`text-xl font-semibold ${l.themeColors.textPrimary}`,children:"Panel de operador"}),(0,t.jsx)("p",{className:`text-sm ${l.themeColors.textSecondary}`,children:"Herramientas del call center para monitorear conductores y viajes."})]}),(0,t.jsxs)("section",{className:"flex-1 px-6 py-8",children:[i&&(0,t.jsx)("p",{className:`text-sm ${l.themeColors.textSecondary}`,children:"Cargando conductores activos..."}),!i&&x&&(0,t.jsx)("p",{className:`text-sm ${l.themeColors.dangerText}`,role:"alert",children:x}),!i&&!x&&(0,t.jsxs)("div",{className:"space-y-8",children:[0===e.length&&(0,t.jsx)("p",{className:`text-sm ${l.themeColors.textSecondary}`,children:"No tienes áreas de servicio asignadas."}),e.map(e=>{let s=u[e.id]||[];return(0,t.jsxs)("div",{className:`rounded-lg border p-4 ${l.themeColors.surface}`,children:[(0,t.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:`text-sm font-semibold ${l.themeColors.textPrimary}`,children:e.name||e.id}),(0,t.jsxs)("p",{className:`text-xs ${l.themeColors.textMuted}`,children:["País: ",e.countryCode||"N/D"]})]}),(0,t.jsxs)("span",{className:`text-xs ${l.themeColors.textSecondary}`,children:["Conductores activos: ",s.length]})]}),0===s.length?(0,t.jsx)("p",{className:`text-xs ${l.themeColors.textMuted}`,children:"No hay conductores activos en esta área."}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full text-left text-xs",children:[(0,t.jsx)("thead",{className:`border-b ${l.themeColors.appBackground}`,children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:`px-2 py-1 font-medium ${l.themeColors.textSecondary}`,children:"Conductor"}),(0,t.jsx)("th",{className:`px-2 py-1 font-medium ${l.themeColors.textSecondary}`,children:"Estado"}),(0,t.jsx)("th",{className:`px-2 py-1 font-medium ${l.themeColors.textSecondary}`,children:"Viaje actual"}),(0,t.jsx)("th",{className:`px-2 py-1 font-medium ${l.themeColors.textSecondary}`,children:"Última actualización"})]})}),(0,t.jsx)("tbody",{children:s.map(e=>(0,t.jsxs)("tr",{className:"border-b last:border-0",children:[(0,t.jsx)("td",{className:`px-2 py-1 ${l.themeColors.textPrimary}`,children:e.driverId}),(0,t.jsx)("td",{className:`px-2 py-1 ${l.themeColors.textSecondary}`,children:e.status||"N/D"}),(0,t.jsx)("td",{className:`px-2 py-1 ${l.themeColors.textSecondary}`,children:e.currentRideId||"Sin viaje"}),(0,t.jsx)("td",{className:`px-2 py-1 ${l.themeColors.textSecondary}`,children:e.lastUpdate?new Date(e.lastUpdate).toLocaleString():"N/D"})]},e.driverId))})]})})]},e.id)})]})]})]})})}e.s(["default",()=>c])}]);